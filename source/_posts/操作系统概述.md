---
title: 操作系统概述
date: 2016-02-16 20:41:26
tags:
- 计算机
---
豆瓣评分`8.8` : [操作系统:精髓与设计原理(第六版)](https://book.douban.com/subject/5064311/) 
<!--more-->

### **调用栈**

> 要想理解数据结构的栈结构, 写个简单的递归程序, 调试的时候查看调用栈(Call Stack),调试一遍就知道了

`调用栈`描述了函数之间的调用关系, 由多个`栈帧(Stack Frame)`组成, 每个栈帧代表着一个未运行完的函数, 栈帧中保存着函数的返回地址和局部变量

![](/img/操作系统概述/stack.png)

- 图示:

1. `esp`是栈指针,始终指向栈顶元素 `ebp`是帧指针, 二者共同组成栈帧的界限

2. 栈帧的末尾存放`主调函数的返回地址`

3. `返回地址`就是当被调函数结束后, 在主调函数继续执行的地方, 本质上就是在栈帧中会存放上一个栈帧的起始地址

- 由图可知, 
1. `函数1`调用`函数2`, `函数2`调用`函数3`
2. 随着函数调用层数的增加, 栈是向低地址方向增长的
3. 当`函数3`调用结束之后, 保存的数据会出栈, `esp`会向高地址移动, 当`esp`与`ebp`重合时说明`函数3`执行过程完全结束, 这时根据保存的上一个栈帧的地址, 使得`ebp`指向`函数2`的栈帧地址,`esp`始终指向栈顶, 这时就界定出`函数2`的栈帧, 也就是返回到了主调函数`函数2`继续执行
4. 就这样一步步结束了整个调用过程

> 栈溢出 : 每一次的函数调用都会向调用栈中增加一个`栈帧`, 当栈顶越界是时导致`栈溢出(Stack Overflow)`


### **段**

![](/img/操作系统概述/segment.jpg)

`段(Segments)`是可执行文件中的概念, 指的是二进制文件内的区域, 该区域包含加载程序到存储器并运行的所有信息
- `正文段.text`用于存储指令, 是只读存储段
- `数据段.data`用于存储已经初始化的全局变量
- `.rodata` ：只读数据
- `BSS段.bss`用于存储未赋值的全局变量所需的空间
- `节头部表(Section Haeders)`用于描述不同节的位置和大小，目标文件中每个节都有一个固定大小的表目
- `段头部表`用于描述不同段的位置和大小, 分为`代码段`和`数据段`

### **运行时存储器映像**

![](/img/操作系统概述/run.png)

- 由图可知,

1. 用户栈和动态内存分配都是在运行时创建的
2. 调用栈所在的段称为`堆栈段(Stack Segment)`

> 堆栈段也有自己的大小, 当越界访问时会出现`段错误`